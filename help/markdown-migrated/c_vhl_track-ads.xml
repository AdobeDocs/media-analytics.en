<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE concept PUBLIC "-//OASIS//DTD DITA Concept//EN" "concept.dtd"[]>
<concept id="concept_F7DE708B27B64027AEC464A6D6C992D2">
  <title>Track Ads</title>
  <shortdesc>The following instructions provide guidance for implementation
	 across all 2.x SDKs. 
  </shortdesc>
  <prolog>
    <metadata>
      <keywords>
        <keyword>Heartbeat Video</keyword>
        <keyword>Video Analytics</keyword>
      </keywords>
      <othermeta name="solution" content="Analytics" />
      <othermeta name="topic" content="Developer and implementation" />
    </metadata>
  </prolog>
  <conbody>
    <note type="important">The following instructions provide guidance for
		implementation across all 2.x SDKs. If you are implementing a 1.x version of
		the SDK, you can download the Developers Guide further down the page. 
	 </note>
    <p>This topic contains the following information: </p>
    <p>
      <ul id="ul_D84E802822744388A8135045E40CF93F">
        <li id="li_1A219326C9EB4DD0BED22A84AC8C6AB9"><xref
            href="c_vhl_track-ads.xml#concept_F7DE708B27B64027AEC464A6D6C992D2/section_D4DE5643337B444D8CF2EE8C6C0AF0BE"
            format="dita" scope="local">Overview</xref></li>
        <li id="li_0941BFD3B596479C97FC93FEF48B6544"><xref
            href="c_vhl_track-ads.xml#concept_F7DE708B27B64027AEC464A6D6C992D2/section_83E0F9406A7743E3B57405D4CDA66F68"
            format="dita" scope="local">Implement</xref></li>
        <li id="li_0E7273F336A74E23A41FB50B3D08C50D"><xref
            href="c_vhl_track-ads.xml#concept_F7DE708B27B64027AEC464A6D6C992D2/section_E4DB582989934DFEBEABA10BF213B36C"
            format="dita" scope="local">Code</xref></li>
        <li id="li_9153F9C8C2F1455C839A65504FDD77ED"><xref
            href="c_vhl_track-ads.xml#concept_F7DE708B27B64027AEC464A6D6C992D2/section_5F1783F5FE2644F1B94B0101F73D57EB"
            format="dita" scope="local">Validate</xref></li>
      </ul>
    </p>
    <section id="section_D4DE5643337B444D8CF2EE8C6C0AF0BE">
      <title>Overview</title>
      <p>Ad playback includes tracking ad breaks, ad starts, ad completes, and
		  ad skips. You can use the video player's API to identify key player events and
		  to populate the required and optional ad variables. 
		</p>
      <p>Here are the key elements to track ad playback: 
		</p>
      <p>
        <b>On ad break start, including pre-roll</b>
      </p>
      <p>
        <ul id="ul_441BBC9304394C99B2C43C35A8772874">
          <li id="li_388FB908A4C645BB8BF8EACCE3853FF5">Create the <codeph>adBreak</codeph> object
            instance for the ad break, for example, <codeph>adBreakObject</codeph>. </li>
          <li id="li_E5CB3EA6DE82435580BBA15139151A7A">Call
              <codeph>trackEvent(MediaHeartbeat.Event.AdBreakStart, adBreakObject);</codeph>. </li>
        </ul>
      </p>
      <p>
        <b>On every ad asset start</b>
      </p>
      <p>
        <ul id="ul_EF5EC86447D243BB88033AE404F849E7">
          <li id="li_2C7C4B6ECFE84EADB6D9C8AB023660AB">Create the ad object instance for the ad
            asset, for example, <codeph>adObject</codeph>. </li>
          <li id="li_4A1CF19B38674655A9C3AD18F8F74397">Populate the ad metadata,
              <codeph>adCustomMetadata</codeph>. </li>
          <li id="li_3ADC43DC3FB845DA863D7635FEE1633B">Call
              <codeph>trackEvent(MediaHeartbeat.Event.AdStart, adObject,
            adCustomMetadata);</codeph>. </li>
        </ul>
      </p>
      <p>
        <b>On every ad asset complete</b>
      </p>
      <p>
        <ul id="ul_296E2D5A3A60405383D6DE57A6D246BB">
          <li id="li_CC3FFFEBB926489BBC31801292BDE142">Call
              <codeph>trackEvent(MediaHeartbeat.Event.AdComplete);</codeph>. </li>
        </ul>
      </p>
      <p>
        <b>On ad skip</b>
      </p>
      <p>
        <ul id="ul_3012A5CC160E4DE7B783A3CCA8AF1B75">
          <li id="li_1BEBCA7827554F6CB37DC672C28841BD">Call
              <codeph>trackEvent(MediaHeartbeat.Event.AdSkip);</codeph>. </li>
        </ul>
      </p>
      <p>
        <b>On ad break complete</b>
      </p>
      <p>
        <ul id="ul_2304476E87594554994D818901F746C8">
          <li id="li_6ECB555F99AB4E08A9E4C2021CA2AEFA">Call
              <codeph>trackEvent(MediaHeartbeat.Event.AdBreakComplete);</codeph>. </li>
        </ul>
      </p>
    </section>
    <section id="section_83E0F9406A7743E3B57405D4CDA66F68">
      <title>Implement</title>
      <p>To implement ad playback: </p>
      <p>
        <ol id="ol_129349FBD79243A9BE9B297C1B9CA2B1">
          <li id="li_D7B681B469E74541BD2AAE62800A7511">Identify when the ad break boundary begins,
            including pre-roll, and create an <codeph>AdBreakObject</codeph> by using the ad break
            information. <p>Here is the Ad break object reference: <table
                id="table_AC3C9A0B8F544DE9BB4A80D22457438F">
                <tgroup cols="3">
                  <colspec colnum="1" colname="col1" colwidth="*"/>
                  <colspec colnum="2" colname="col2" colwidth="*"/>
                  <colspec colnum="3" colname="col3" colwidth="*" align="center"/>
                  <thead>
                    <row>
                      <entry colname="col1" align="center">Variable Name </entry>
                      <entry colname="col2" align="center">Description </entry>
                      <entry colname="col3" align="center">Required </entry>
                    </row>
                  </thead>
                  <tbody>
                    <row>
                      <entry colname="col1"><codeph>name</codeph></entry>
                      <entry colname="col2">
                        <p>Ad break name such as pre-roll, mid-roll, and post-roll. </p>
                      </entry>
                      <entry colname="col3">
                        <p>Yes </p>
                      </entry>
                    </row>
                    <row>
                      <entry colname="col1"><codeph>position</codeph></entry>
                      <entry colname="col2">
                        <p>The number position of the ad break starting with 1. </p>
                      </entry>
                      <entry colname="col3">
                        <p>Yes </p>
                      </entry>
                    </row>
                    <row>
                      <entry colname="col1"><codeph>startTime</codeph></entry>
                      <entry colname="col2">
                        <p>Playhead value at the start of the ad break. </p>
                      </entry>
                      <entry colname="col3">
                        <p>Yes </p>
                      </entry>
                    </row>
                  </tbody>
                </tgroup>
              </table></p><p>The general format for the ad break object is:
              <codeblock outputclass="syntax javascript">var adBreakObject = MediaHeartbeat.createAdBreakObject(&lt;ADBREAK_NAME&gt;, &lt;POSITION&gt;, &lt;START_TIME&gt;);</codeblock></p></li>
          <li id="li_61053DBF6FC641D899912F88875F5992">Call <codeph>trackEvent()</codeph> with
              <codeph>AdBreakStart</codeph> in the <codeph>MediaHeartbeat</codeph> instance to begin
            tracking the ad break. <p>
              <codeblock outputclass="syntax javascript">mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdBreakStart, adBreakObject);</codeblock>
            </p></li>
          <li id="li_6F351516F9914172A201632B6033FF3D">Identify when the ad asset starts and create
            an <codeph>AdObject</codeph> instance using the ad information. <p>Here is the
                <codeph>AdObject</codeph> reference: <table
                id="table_2B208589ABAA4CF2A476934578D3BEF3">
                <tgroup cols="3">
                  <colspec colnum="1" colname="col1" colwidth="2&quot;" align="center"/>
                  <colspec colnum="2" colname="col2" colwidth="3&quot;"/>
                  <colspec colnum="3" colname="col3" colwidth="2&quot;" align="center"/>
                  <thead>
                    <row>
                      <entry colname="col1">Variable Name </entry>
                      <entry colname="col2">Description </entry>
                      <entry colname="col3">Required </entry>
                    </row>
                  </thead>
                  <tbody>
                    <row>
                      <entry colname="col1"><codeph>name</codeph></entry>
                      <entry colname="col2">
                        <p>Friendly name of the ad asset. </p>
                      </entry>
                      <entry colname="col3">
                        <p>Yes </p>
                      </entry>
                    </row>
                    <row>
                      <entry colname="col1"><codeph>adId</codeph></entry>
                      <entry colname="col2">
                        <p>Unique identified for the ad asset. </p>
                      </entry>
                      <entry colname="col3">
                        <p>Yes </p>
                      </entry>
                    </row>
                    <row>
                      <entry colname="col1"><codeph>position</codeph></entry>
                      <entry colname="col2">
                        <p>The number position of the asset in the ad break, starting with 1. </p>
                      </entry>
                      <entry colname="col3">
                        <p>Yes </p>
                      </entry>
                    </row>
                    <row>
                      <entry colname="col1"><codeph>length</codeph></entry>
                      <entry colname="col2">
                        <p>Ad asset length </p>
                      </entry>
                      <entry colname="col3">
                        <p>Yes </p>
                      </entry>
                    </row>
                  </tbody>
                </tgroup>
              </table></p><p>The general format for the ad object is:
              <codeblock outputclass="syntax javascript">var adObject = MediaHeartbeat.createAdObject(&lt;AD_NAME&gt;, &lt;AD_ID&gt;, &lt;POSITION&gt;, &lt;LENGTH&gt;);</codeblock></p></li>
          <li id="li_8AA3DE611FF34101A7B302ADD3CCBFEE">Attach all the custom ad metadata to the
            video tracking session through context data variables. <p>For custom metadata, create a
              variable object for the custom data variables and populate with the data for the
              current ad asset. For example:
              <codeblock outputclass="syntax javascript">/* Set custom context data */
var adCustomMetadata = {
    affiliate: "Sample affiliate",
    campaign: "Sample ad campaign",
    creative: "Sample creative"
};
</codeblock></p></li>
          <li id="li_80F873C75CBB42E98E2F576700BFF606">Call <codeph>trackEvent()</codeph> with the
              <codeph>AdStart</codeph> event in the <codeph>MediaHeartbeat</codeph> instance to
            begin tracking the ad playback. <p>Be sure to include a reference to your custom
              metadata variable as the third parameter in the event call:
              <codeblock outputclass="syntax javascript">mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdStart, adObject, adCustomMetadata);</codeblock></p></li>
          <li id="li_788B5D82E24F46A1A4AF69FC9E3A5374">When the ad asset playback reaches the end of
            the ad, call <codeph>trackEvent()</codeph> with the <codeph>AdComplete</codeph> event. <p>
              <codeblock outputclass="syntax javascript">mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdComplete);</codeblock>
            </p></li>
          <li id="li_E3F10AEC2FA94AC38BE7A2761B18AFEB"> If ad playback did not complete because the
            user chose to skip the ad, track the <codeph>AdSkip</codeph> event. <p>
              <codeblock outputclass="syntax javascript">mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdSkip);</codeblock>
            </p></li>
          <li id="li_A2CEFF7EAEB9498FB74AA7B3E4B9901F">When the ad break is complete, use the
              <codeph>AdBreakComplete</codeph> event to track. <p>
              <codeblock outputclass="syntax javascript">mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdBreakComplete);</codeblock>
            </p></li>
        </ol>
      </p>
      <p>The following sample code utilizes our JavaScript 2.x SDK for an HTML5 video player.
        <codeblock outputclass="syntax javascript">/* Call on ad break start */

if (e.type == "ad break start") {
    var adBreakObject = MediaHeartbeat.createAdBreakObject("mid-roll", 2, 500);
    this.mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdBreakStart, adBreakObject);
};

/* Call on ad start */
if (e.type == "ad start") {
    var adObject = MediaHeartbeat.createAdObject("PepsiOne", "123456ab", 1, 30);
    /* Set custom context data */
    var adCustomMetadata = {
        affiliate:"Sample affiliate",
        campaign:"Sample ad campaign",
        creative:"Sample creative"
    }
    this.mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdStart, adObject, adCustomMetadata);
};

/* Call on ad complete */
if (e.type == "ad complete") {
    this.mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdComplete);
};

/* Call on ad skip */
if (e.type == "ad skip") {
    this.mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdSkip);
};
    
/* Call on ad break complete */
if (e.type == "ad break complete") {
    this.mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdBreakComplete);
};
</codeblock></p>
    </section>
    <section id="section_B58A8CD1650443F4B82483E6CB0EE894">
      <title>Code</title>
      <table id="table_1FC1BC9FE48C4B8699B84EE4138315D5">
        <tgroup cols="2" rowsep="1">
          <colspec colnum="1" colname="col1" colwidth="2&quot;"/>
          <colspec colname="col3" colnum="2" colwidth="2&quot;"/>
          <thead>
            <row>
              <entry>Video Analytics 2.x SDKs </entry>
              <entry colname="col3" align="center">Developer Guides </entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry>Android/FireTV </entry>
              <entry colname="col3">
                <xref
                  href="https://marketing.adobe.com/resources/help/en_US/sc/appmeasurement/hbvideo/android_2.0/t_vhl_track-ads_android.html"
                  format="html" scope="external">Track Ads for Android</xref>
              </entry>
            </row>
            <row>
              <entry>iOS/AppleTV </entry>
              <entry colname="col3">
                <xref
                  href="https://marketing.adobe.com/resources/help/en_US/sc/appmeasurement/hbvideo/ios_2.0/t_vhl_track-ads_ios.html"
                  format="html" scope="external">Track Ads for iOS</xref>
              </entry>
            </row>
            <row>
              <entry>JavaScript </entry>
              <entry colname="col3">
                <xref
                  href="https://marketing.adobe.com/resources/help/en_US/sc/appmeasurement/hbvideo/js_2.0/t_vhl_track-ads_js.html"
                  format="html" scope="external">Track Ads for JavaScript</xref>
              </entry>
            </row>
            <row>
              <entry>Roku </entry>
              <entry colname="col3">
                <xref
                  href="https://marketing.adobe.com/resources/help/en_US/sc/appmeasurement/hbvideo/roku/c_vhl_conf-med-hrbts.html"
                  format="html" scope="external">Track Ads for Roku</xref>
              </entry>
            </row>
            <row>
              <entry>Chromecast</entry>
              <entry colname="col3"><xref
                  href="https://marketing.adobe.com/resources/help/en_US/sc/appmeasurement/hbvideo/chromecast/c_vhl_conf-med-hrbts-chromecast.html"
                  format="html" scope="external">Track Ads for Chromecast</xref></entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <table id="table_DCD074D23E704CA79BC3734D1CF59A5B">
        <tgroup cols="2">
          <colspec colnum="1" colname="col1" colwidth="2&quot;" align="center"/>
          <colspec colname="col3" colnum="2" colwidth="3&quot;"/>
          <thead>
            <row>
              <entry>Video Analytics 1.x SDKs* </entry>
              <entry colname="col3" align="center">Developer Guides </entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry>Android </entry>
              <entry colname="col3">
                <xref href="vhl-dev-guide-v15_android.pdf" format="pdf" scope="peer">Track Ads for
                  Android</xref>
              </entry>
            </row>
            <row>
              <entry>AppleTV </entry>
              <entry colname="col3">
                <xref href="vhl-dev-guide-v1x_appletv.pdf" format="pdf" scope="peer">Track Ads for
                  AppleTV</xref>
              </entry>
            </row>
            <row>
              <entry>Chromecast </entry>
              <entry colname="col3">
                <xref href="chromecast_1.x_sdk.pdf" format="pdf" scope="peer">Track Ads for
                  Chromecast</xref>
              </entry>
            </row>
            <row>
              <entry>iOS </entry>
              <entry colname="col3">
                <xref href="vhl-dev-guide-v15_ios.pdf" format="pdf" scope="peer">Track Ads for
                  iOS</xref>
              </entry>
            </row>
            <row>
              <entry>JavaScript </entry>
              <entry colname="col3">
                <xref href="vhl-dev-guide-v15_js.pdf" format="pdf" scope="peer">Track Ads for
                  JavaScript</xref>
              </entry>
            </row>
            <row>
              <entry>Primetime </entry>
              <entry colname="col3">
                <ul id="ul_AE4FACC564D84FAF8BF241912B5D7761">
                  <li id="li_372AFC4170B546E9867C160DBAAC0A5E">
                    <b>Android</b>: <xref
                      href="http://help.adobe.com/en_US/primetime/psdk/android/1.4/index.html#PSDKs-task-Initialize_and_configure_video_analytics_"
                      format="html" scope="external">Configure Video Analytics</xref></li>
                  <li id="li_224523B07B224A5099F18F06B0D14C87">
                    <b>DHLS</b>: <xref
                      href="http://help.adobe.com/en_US/primetime/psdk/dhls/index.html#PSDKs-task-Initialize_and_configure_video_analytics_ "
                      format="html" scope="external">Configure Video Analytics</xref></li>
                  <li id="li_C6A942B9468E45F0A9B1FA7CEF667BAF">
                    <b>iOS</b>: <xref
                      href="http://help.adobe.com/en_US/primetime/psdk/ios/1.4/index.html#PSDKs-task-Initialize_and_configure_video_analytics_"
                      format="html" scope="external">Configure Video Analytics</xref></li>
                </ul>
              </entry>
            </row>
            <row>
              <entry>TVML </entry>
              <entry colname="col3">
                <xref href="vhl_tvml.pdf" format="pdf" scope="peer">Track Ads for TVML</xref>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <p>
        <b>*</b> For all 1.x SDKs, the links are for the full PDF download of
		  the documentation. 
		</p>
    </section>
    <section id="section_5F1783F5FE2644F1B94B0101F73D57EB">
      <title>Validate</title>
      <p>
        <b>Ad Start</b>
      </p>
      <p>On start of an individual ad playback, three key calls are sent in the following order: </p>
      <p>
        <ol id="ol_1161E2EEC66342518A6BFF96B055BA98">
          <li id="li_76069E715BF249DD854E18CE6776B3EC">Video ad analytics start<b>*</b></li>
          <li id="li_C72E548811B744BC924A555AAF4F9F6D">Heartbeat ad start<b>*</b></li>
          <li id="li_77D50FD1F8924B08A5B9EF25C7CDB95E">Heartbeat analytics start </li>
        </ol>
      </p>
      <p>
        <b>*</b>These calls contain additional metadata variables for both
		  custom and standard. 
		</p>
      <p>
        <b>Ad Play</b>
      </p>
      <p>During ad playback, Heartbeat ad play calls are sent to the Heartbeat
		  server every ten seconds. 
		</p>
      <p>
        <b>Ad Complete</b>
      </p>
      <p>At the 100% point on an ad, a Heartbeat ad complete call will be sent.
		  
		</p>
      <p>
        <b>Ad Skip</b>
      </p>
      <p>When an ad is skipped, no events are sent, so the tracking calls will
		  not include the ad information. 
		</p>
      <note type="tip">No unique calls are sent on ad break start and ad break
		  complete. 
		</note>
    </section>
  </conbody>
</concept>